<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>–ú–æ–π —á–∞—Ç</title>

    <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
    <link rel="shortcut icon" href="/favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="MyChat" />
    <link rel="manifest" href="/favicon/site.webmanifest" />

  <link rel="stylesheet" href="/static/style.css">

</head>
<body>
  <!-- Mobile menu overlay -->
  <div class="mobile-overlay" id="mobileOverlay"></div>
  
  <!-- Mobile menu button -->
  <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="–ú–µ–Ω—é">
    <span></span>
    <span></span>
    <span></span>
  </button>

  <div class="sidebar" id="sidebar">
    <div class="top-bar">
      <span class="user-info">üë§ {{ username }}</span>
      <a href="/logout" class="logout-btn">–í—ã–π—Ç–∏</a>
    </div>
    <h4>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h4>
    <ul id="users-list"></ul>
    
    <div class="rooms-section">
      <div class="rooms-header">
        <h4>–ö–æ–º–Ω–∞—Ç—ã</h4>
        <button class="create-room-btn" id="createRoomBtn" title="–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É">+</button>
      </div>
      <ul id="rooms-list"></ul>
    </div>
  </div>
  
  <!-- Room Creation Modal -->
  <div class="modal-overlay" id="roomModalOverlay">
    <div class="modal" id="roomModal">
      <h3>–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h3>
      <form id="createRoomForm">
        <input type="text" id="roomName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã" required>
        <textarea id="roomDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" rows="3"></textarea>
        <div class="modal-buttons">
          <button type="submit" class="btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
          <button type="button" class="btn-secondary" id="cancelRoomBtn">–û—Ç–º–µ–Ω–∞</button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Room Management Modal -->
  <div class="modal-overlay" id="roomManageModalOverlay">
    <div class="modal" id="roomManageModal">
      <h3 id="roomManageTitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–æ–π</h3>
      <div id="roomManageContent"></div>
      <div class="modal-buttons">
        <button type="button" class="btn-secondary" id="closeRoomManageBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <div class="chat-container">
    <div id="chat-header">
      <button class="mobile-back-btn" id="mobileBackBtn" aria-label="–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É">‚Üê</button>
      <div class="chat-header-content">
        <h3 id="chat-with">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —á–∞—Ç–∞</h3>
        <div class="room-description" style="display: none;"></div>
      </div>
    </div>
    <div id="chat-messages"></div>
    <div class="reply-indicator" id="replyIndicator" style="display: none;">
      <div class="reply-indicator-content">
        <span class="reply-indicator-text">Reply to <strong id="replyToUser"></strong>:</span>
        <span class="reply-indicator-quote" id="replyToQuote"></span>
      </div>
      <button class="reply-indicator-close" id="replyIndicatorClose" aria-label="Cancel reply">√ó</button>
    </div>
    <div class="composer">
      <input id="input" autocomplete="off" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." />
      <button id="sendBtn" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
  </div>

  <!-- –ü–µ—Ä–µ–¥–∞—ë–º username –≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π JS -->
  <script>
    // –±–µ–∑–æ–ø–∞—Å–Ω–æ: username –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑ Jinja
    window.CURRENT_USERNAME = "{{ username }}";
  </script>

  <!-- –°–∫—Ä–∏–ø—Ç —á–∞—Ç–∞ -->
  <script src="/static/chat.js"></script>
</body>
</html>
